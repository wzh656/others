<!DOCTYPE html>
<html lang="zh">
	<head>
		<meta charset="UTF-8" />
		<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
		<title>钢琴</title>
		
		<!--icon-->
		<link href="./img/icon.png" rel="icon" type="image/x-icon"/>
		
		<script src="./js/jquery.min.js"></script> <!-- jq -->
		<script src="./js/acoustic_grand_piano-ogg.js"></script> <!-- 钢琴声音 -->
		
	</head>
	<body>
		
		<button onclick="start()">start</button>
		
<script>
function play(sound, time=1, volume=1){
	return new Promise((resolve, reject)=>{
		console.log(sound, time, volume)
		if (sound){
			const bgm = $("<audio></audio>")
				.attr("volume", volume)
				.attr("src", MIDI.Soundfont.acoustic_grand_piano[sound]);
			bgm[0].play();
		}
		setTimeout(resolve, time/2*1.5*1000);
	});
}

function start(){
	console.log("start")
	play("A3", 0.5)
	.then(()=> play("C4", 0.5) )
	.then(()=> play("D4", 0.5) )
	.then(()=> play("E4", 0.5) )
	.then(()=> play("D4", 1) )
	.then(()=> play(null, 0.5) )
	
	.then(()=> play("E4", 0.5) )
	.then(()=> play("G4", 0.75) )
	.then(()=> play("D4", 0.5) )
	.then(()=> play("C4", 0.5) )
	.then(()=> play("A3", 1) )
	// .then(()=> play(null, 0.25) )
	
	.then(()=> play("E4", 0.5) )
	.then(()=> play("D4", 0.5) )
	.then(()=> play("A3", 1) )
	.then(()=> play("E4", 0.5) )
	.then(()=> play("D4", 1) )
	.then(()=> play("E4", 0.5) )
	.then(()=> play("A3", 1) )
	.then(()=> play(null, 0.5) )
	
	.then(()=> play(null, 1) )
	.then(start)
}

</script>
	</body>
</html>
